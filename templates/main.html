<!doctype html> 

<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>     <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>     <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>{{ page_title }}</title>
    <link rel="stylesheet" href="{{ static_url("css/style.css") }}" />
    <link rel="stylesheet" href="{{ static_url("css/libs/normalize/normalize.css") }}" />
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>

    <header>
    </header><!-- end header -->

    <div id="main">
        <div id="container">
            <h1>{{ page_heading }}</h1>

            <p> Hello boys & girls 123</p>

            <section class="main">
			 <form class="search" autocomplete="off" method="post" action="index.html" >
				 <input id="address_text_box" type="text" name="q" placeholder="Address..."/>
				 <ul class="results" >
				 </ul>
			 </form>
		</section>
        </div><!-- end container -->
    </div><!-- end main -->

    <footer>
    </footer><!-- end footer -->

    <!-- Load jQuery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
    <script>!window.jQuery && document.write('<script src="{{ static_url("js/libs/jquery/jquery-1.10.1.min.js") }}"><\/script>')</script>

    <!-- plugins -->
    <script src="{{ static_url("js/plugins.js") }}"></script>

    <!-- main script -->
    <script src="{{ static_url("js/script.js") }}"></script>

    <script type="text/javascript">

        $( document ).ready(function() {
            console.log( "ready!" );
            $(".results").hide();
        });

    	var addresses = ["Greean street", "Brown street", "Pink street"];
        var data = "hello";
        var success = false;
        var address = "preaddress=";
        var response = '';

        function loadAddressToTextBox(pos){
            console.log('loadAddressToTextBox');
            $(".results").hide();
            jQuery('#address_text_box').val(pos.name);
            console.log('address loaded');
        }


    	jQuery('#address_text_box').on('input', function(){

            console.log('Data in the box : ' + $( "#address_text_box" ).val());
    	   // Make a get call to fetch the address for completion
            $.ajax({
              url: "http://localhost:5000/fetchAddress",
              data: address + $( "#address_text_box" ).val(),
              success: function(data) {
                    console.log(data);
                    addresses = jQuery.parseJSON(data);

                    console.log("response -->");
                    console.log(addresses);

                    $( ".results" ).empty();
                    $(".results").show();
                    console.log('SearchAddress called');
                    for (var address in addresses) {
                        console.log('inside for');
                        console.log(address);
                        console.log(addresses[address]);
                        $(".results").append("<li ><a href=\"#\" onClick=\"loadAddressToTextBox(this);\" name=\"" + address + "\" >" + address + "</a></li>");
                    }
                }
              
            });

            $("#address_text_box").focus(function(){
              $('.results').css("display","block");
            });
    		
    	});
        
        
    </script>

    </body>
</html>